#!/bin/sh
. "$(dirname "$0")/_/husky.sh"

# Remove lint-staged automatic backups to keep the stash clean
if ! git rev-parse --is-inside-work-tree >/dev/null 2>&1; then
  exit 0
fi

stashes=$(git stash list | awk -F: '/lint-staged automatic backup/ {gsub(/stash@\{|\}/,"",$1); print $1}' | sort -nr)
if [ -z "$stashes" ]; then
  exit 0
fi

for idx in $stashes; do
  git stash drop "stash@{$idx}" >/dev/null 2>&1 || true
done
